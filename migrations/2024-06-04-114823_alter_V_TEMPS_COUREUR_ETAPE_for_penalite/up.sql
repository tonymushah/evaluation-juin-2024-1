-- Your SQL goes here
-- Your SQL goes here
CREATE OR REPLACE VIEW v_temps_coureur_etape_equipe_coureur as 
SELECT
	TCE.ETAPE,
	TCE.LONGUEUR,
	TCE.NOM,
	TCE.NB_COUREUR_PAR_EQUIPE,
	TCE.TEMPS + COALESCE(PE.VALEUR, 0) as TEMPS,
	TCE.POINTS,
	TCE.EQUIPE_COUREUR,
	TCE.DEPART,
	EC.COUREUR,
	EC.EQUIPE
FROM
	V_TEMPS_COUREUR_ETAPE AS TCE
	JOIN EQUIPE_COUREUR AS EC ON TCE.EQUIPE_COUREUR = EC.ID_EQUIPE_COUREUR
    LEFT JOIN PENALITE AS PE ON PE.EQUIPE = EC.EQUIPE AND PE.ETAPE = TCE.ETAPE;